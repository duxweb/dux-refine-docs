"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var it=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var H=()=>typeof document>"u"?new URL("file:"+__filename).href:document.currentScript&&document.currentScript.src||new URL("main.js",document.baseURI).href,c=H();var _path = require('path'); var _path2 = _interopRequireDefault(_path);var _url = require('url');var lt=()=>process.env.NODE_ENV==="production",ut= exports.d =/(c|m)?tsx?$/,mt= exports.e =/\.mdx?$/,a= exports.f =_path.join.call(void 0, _url.fileURLToPath.call(void 0, c),"../../.."),R= exports.g =_path.join.call(void 0, a,"src/runtime"),ft= exports.h =_path.join.call(void 0, a,"src/shared"),dt= exports.i =_path.join.call(void 0, R,"index.ts"),gt= exports.j =_path.join.call(void 0, R,"client-entry.tsx"),ht= exports.k =_path.join.call(void 0, R,"ssr-entry.tsx"),U= exports.l =_path.join.call(void 0, a,"src/theme-default"),Et= exports.m ="public",S= exports.n =_path.join.call(void 0, a,"node_modules",".island"),Tt= exports.o =_path.join.call(void 0, ".island"),M="ssr-entry.mjs",Rt= exports.p =_path.join.call(void 0, S,"ssr",M),xt=_path.join.call(void 0, S,"routes.tsx"),Pt= exports.q =_path.join.call(void 0, a,"template.html"),_t= exports.r ="!!ISLAND!!",Dt= exports.s =["react","react-dom","react-dom/client","react/jsx-runtime"],F=_path.join.call(void 0, a,"dist","node"),x=_path.join.call(void 0, a,"dist","runtime"),Ct= exports.t =x,Ut= exports.u =_path.join.call(void 0, F,"cli.js"),St= exports.v =_path.join.call(void 0, a,"vendors"),At= exports.w =["tip","warning","danger","info"],Lt= exports.x ="virtual:custom-styles",vt= exports.y ="virtual:ui-components";var _fsextra = require('fs-extra'); var _fsextra2 = _interopRequireDefault(_fsextra);var _picocolors = require('picocolors'); var _picocolors2 = _interopRequireDefault(_picocolors);var A="island-theme-appearance",Nt= exports.b =["https://island-tutorial.sanyuan0704.top","https://island.sanyuan0704.top","https://islandjs.dev"],L=/^(https?:)?\/\//;var _vite = require('vite');var{pathExistsSync:P}=_fsextra2.default,f=(t,...e)=>_path2.default.resolve(t,".island",...e),X=t=>{if(t){let[e]=t.split(".");return e}else return"config"},z=(t,e)=>{try{let o=["js","ts"],r=X(e),i=o.map(n=>f(t,`${r}.${n}`)).find(P);if(r!=="config"&&!P(i)){let n=f(t,`${e}`);throw new Error(`failed to load config from ${n}`)}return i}catch(o){throw console.log(_picocolors2.default.red("failed to load config file")),o}};async function W(t,e,o,r){let i=z(t,r),n=await _vite.loadConfigFromFile.call(void 0, {command:e,mode:o},i,t);if(n){let{config:l={},dependencies:E=[],path:m}=n,T=await(typeof l=="function"?l():l);return[m,T,E]}else return[i,{},[]]}function V(t){let e=_nullishCoalesce(_optionalChain([t, 'optionalAccess', _2 => _2.head]), () => ([]));return(_nullishCoalesce(_optionalChain([t, 'optionalAccess', _3 => _3.appearance]), () => (!0)))&&e.push(["script",{id:"check-dark-light"},`
        ;(() => {
          const saved = localStorage.getItem('${A}')
          const prefereDark = window.matchMedia('(prefers-color-scheme: dark)').matches
          if (!saved || saved === 'auto' ? prefereDark : saved === 'dark') {
            document.documentElement.classList.add('dark')
          }
        })()
      `]),e}function Y(t,e){return{lang:t.lang||"en-US",title:t.title||"Island",description:t.description||"Island",themeConfig:t.themeConfig||{},head:V(t),base:t.base||"",icon:t.icon||"",root:e,appearance:_nullishCoalesce(t.appearance, () => (!0))}}async function kt(t,e,o,r){let[i,n,l]=await W(t,e,o,r),E=_path2.default.resolve(t,n.srcDir||""),m=f(t,"theme"),T=P(m)?m:U,{pluginSearch:y}=await Promise.resolve().then(() => require(`@islandjs/plugin-search/dist/index.js?t=${Date.now()}`)),{pluginBackTop:b}=await Promise.resolve().then(() => require(`@islandjs/plugin-backtop/dist/index.js?t=${Date.now()}`)),O=[y(),b()];return{root:t,srcDir:E,outDir:n.outDir,themeDir:T,configPath:i,configDeps:l,base:n.base||"",tempDir:f(t,"node_modules",".island"),vite:{...n.vite,base:_nullishCoalesce(n.base, () => ("/"))},allowDeadLinks:_nullishCoalesce(n.allowDeadLinks, () => (!1)),siteData:Y(n,t),enableSpa:_nullishCoalesce(n.enableSpa, () => (!0)),route:_nullishCoalesce(n.route, () => ({})),markdown:_nullishCoalesce(n.markdown, () => ({})),plugins:O.concat(n.plugins||[])}}function Bt(t){return t}var _fastglob = require('fast-glob'); var _fastglob2 = _interopRequireDefault(_fastglob);var w=["**/node_modules/**","**/.*","**/dist/**"],d="virtual:routes",I=["js","jsx","ts","tsx","md","mdx"],p,D;function Yt(t={}){let{root:e="src"}=t,o;return{name:"island:vite-plugin-routes",async configResolved(){o=_path2.default.isAbsolute(e)?_path2.default.join(e):_path2.default.join(process.cwd(),e),p= exports.G =new h(_vite.normalizePath.call(void 0, o),t),await p.init(),D=new RegExp(`\\.(${p.getExtensions().join("|")})$`)},resolveId(r){if(r===d)return"\0"+d},load(r,i){if(r==="\0"+d)return{code:p.generateRoutesCode(_optionalChain([i, 'optionalAccess', _4 => _4.ssr])),moduleSideEffects:!1}},configureServer(r){let i=()=>{let n=r.moduleGraph.getModuleById(`\0${d}`);n&&(r.moduleGraph.invalidateModule(n),r.ws.send({type:"full-reload"}))};r.watcher.add(o).on("add",async n=>{n.startsWith(o)&&D.test(n)&&(await p.addRoute(n),i())}).on("unlink",async n=>{n.startsWith(o)&&D.test(n)&&(await p.removeRoute(n),i())})}}}var q=/\?.*$/s,J=/#.*$/s,Zt= exports.B =t=>t.replace(J,"").replace(q,"");function N(t){return t.charAt(0)==="/"||t.startsWith("https")?t:"/"+t}function Q(t){return t.charAt(t.length-1)==="/"?t.slice(0,-1):t}function Z(t){return Q(N(t))}function C(t,e){if(L.test(t))return t;let o=Z(e),r=N(t);return o?`${o}${r}`:r}var ot=t=>t.startsWith("/")?t:`/${t}`,g= exports.E =t=>(t=t.replace(/\.(.*)?$/,"").replace(/index$/,""),ot(t)),nt=_fsextra2.default.readFileSync(_path2.default.join(x,"lazyWithPreload.js"),"utf-8"),h= exports.F =class{constructor(e,o){this.scanDir=e;this.#e=o.extensions||I,this.#o=o.include||[],this.#n=o.exclude||[],this.#r=o.prefix||""}#t=[];#e=[];#o=[];#n=[];#r="";async init(){_fastglob2.default.sync([`**/*.{${this.#e.join(",")}}`,...this.#o],{cwd:this.scanDir,absolute:!0,ignore:[...w,...this.#n]}).sort().forEach(o=>this.addRoute(o))}static getRoutePathFromFile(e,o,r){let i=_path2.default.relative(o,e),n=g(i);return C(n,r)}addRoute(e){let o=_vite.normalizePath.call(void 0, _path2.default.relative(this.scanDir,e)),r=g(o),i=_path2.default.join(this.scanDir,o);this.#t.push({routePath:r,basePath:this.scanDir,absolutePath:_vite.normalizePath.call(void 0, i)})}removeRoute(e){let o=_path2.default.relative(this.scanDir,e),r=g(o);this.#t=this.#t.filter(i=>i.routePath!==r)}getRoutes(){return this.#t}isExistRoute(e){return this.#t.find(o=>o.routePath===e)}generateRoutesCode(e){return`
${nt.toString()};
import React from 'react';
${this.#t.map((o,r)=>e?`import * as Route${r} from '${o.absolutePath}';`:`const Route${r} = lazyWithPreload(() => import('${o.absolutePath}'))`).join(`
`)}
export const routes = [
${this.#t.map((o,r)=>{let i=e?`() => Route${r}`:`Route${r}.preload`,n=e?`Route${r}.default`:`Route${r}`;return`{ path: '${C(o.routePath,this.#r)}', element: React.createElement(${n}), filePath: '${o.absolutePath}', preload: ${i} }`}).join(`,
`)}
];
`}getExtensions(){return this.#e}};exports.a = it; exports.b = Nt; exports.c = lt; exports.d = ut; exports.e = mt; exports.f = a; exports.g = R; exports.h = ft; exports.i = dt; exports.j = gt; exports.k = ht; exports.l = U; exports.m = Et; exports.n = S; exports.o = Tt; exports.p = Rt; exports.q = Pt; exports.r = _t; exports.s = Dt; exports.t = Ct; exports.u = Ut; exports.v = St; exports.w = At; exports.x = Lt; exports.y = vt; exports.z = kt; exports.A = Bt; exports.B = Zt; exports.C = Z; exports.D = C; exports.E = g; exports.F = h; exports.G = p; exports.H = Yt;
//# sourceMappingURL=chunk-RWA7RXZ7.cjs.map