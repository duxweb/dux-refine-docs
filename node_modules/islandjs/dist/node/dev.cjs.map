{"version":3,"sources":["../../src/node/dev.ts"],"names":["createViteDevServer","cleanOptions","options","option","createDevServer","root","cliOptions","restartServer","config","resolveConfig","createVitePlugins"],"mappings":"kFAAA,OAAS,gBAAgBA,MAA2B,OAKpD,SAASC,EAAaC,EAAuB,CAC3C,IAAMC,EAAS,CAAE,GAAGD,CAAQ,EAC5B,cAAOC,EAAO,IAAI,EAClB,OAAOA,EAAO,SACd,OAAOA,EAAO,MACd,OAAOA,EAAO,SACd,OAAOA,EAAO,YACd,OAAOA,EAAO,OACPA,CACT,CACA,eAAsBC,EACpBC,EAAO,QAAQ,IAAI,EACnBC,EACAC,EACA,CACA,IAAMC,EAAS,MAAMC,EACnBJ,EACA,QACA,cACAC,EAAW,MACb,EACA,OAAON,EAAoB,CACzB,KAAAK,EACA,KAAM,IACN,aAAc,CAAE,MAAOC,EAAW,KAAM,EACxC,SAAUA,EAAW,SACrB,SAAUA,EAAW,SACrB,YAAaA,EAAW,YACxB,OAAQL,EAAaK,CAAU,EAC/B,QAAS,CAAC,MAAMI,EAAkBF,EAAQ,GAAOD,CAAa,CAAC,CACjE,CAAC,CACH","sourcesContent":["import { createServer as createViteDevServer } from 'vite';\nimport { CLIDevOption } from './cli';\nimport { resolveConfig } from './config';\nimport { createVitePlugins } from './vitePlugin';\n\nfunction cleanOptions(options: CLIDevOption) {\n  const option = { ...options };\n  delete option['--'];\n  delete option.cacheDir;\n  delete option.force;\n  delete option.logLevel;\n  delete option.clearScreen;\n  delete option.config;\n  return option;\n}\nexport async function createDevServer(\n  root = process.cwd(),\n  cliOptions: CLIDevOption,\n  restartServer: () => Promise<void>\n) {\n  const config = await resolveConfig(\n    root,\n    'serve',\n    'development',\n    cliOptions.config\n  );\n  return createViteDevServer({\n    root,\n    base: '/',\n    optimizeDeps: { force: cliOptions.force },\n    cacheDir: cliOptions.cacheDir,\n    logLevel: cliOptions.logLevel,\n    clearScreen: cliOptions.clearScreen,\n    server: cleanOptions(cliOptions),\n    plugins: [await createVitePlugins(config, false, restartServer)]\n  });\n}\n"]}